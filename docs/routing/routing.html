<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
			<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-73924704-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

		gtag('config', 'UA-73924704-2', { 'anonymize_ip': true });
</script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0">
    <title>What is Routing?</title>
    <link rel="icon" type="image/png" href="../../assets/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="../../assets/favicon-16x16.png" sizes="16x16" />
    <link href=“https://fonts.googleapis.com/css?family=IBM+Plex+Sans” rel=“stylesheet”>
    <link rel="stylesheet" href="../../css/reset.css">
    <link rel="stylesheet" href="../../css/dist/docs.css">
  </head>
<body>
  <section class="docs-grid-container">
    <aside id="sidebar" class="docs-item-1 docs-sidebar">
      <h1 class="docs-title"><a href="/index.html">KITURA <span class="blue-text">DOCS</span></a></h1>
      <div class="underline-title"></div>
      <ul class="sidebar-list">
        <li class="sidebar-item collapsible">Getting Started</li>
        <ul class="nested-sidebar-list content">
          <li class="nested-sidebar-item"><a href="../getting-started/installation-mac.html">Install Swift for macOS</a></li>
          <li class="nested-sidebar-item"><a href="../getting-started/installation-linux.html">Install Swift for Linux</a></li>
          <li class="nested-sidebar-item"><a href="../getting-started/hello-world.html">Hello World</a></li>
          <li class="nested-sidebar-item"><a href="../getting-started/create-server.html">Create a server</a></li>

          <li class="nested-sidebar-item"><a href="../getting-started/update-package.html">Adding Packages</a></li>
        </ul>
        <li class="sidebar-item collapsible">Logging</li>
        <ul class="nested-sidebar-list content">
          <li class="nested-sidebar-item"><a href="../logging/logging.html">What is Logging?</a></li>
          <li class="nested-sidebar-item"><a href="../logging/helium-logger.html">Helium Logger</a></li>
        </ul>
        <li class="sidebar-item collapsible">Routing</li>
        <ul class="nested-sidebar-list content" style="max-height: 250px;">
          <li class="nested-sidebar-item active"><a href="../routing/routing.html">What is routing?</a></li>
          <li class="nested-sidebar-item"><a href="../routing/codable-routing.html">Codable routing</a></li>
          <li class="nested-sidebar-item"><a href="../routing/raw-routing.html">Raw routing</a></li>
          <li class="nested-sidebar-item"><a href="../routing/open-api.html">OpenAPI</a></li>
        </ul>
        <li class="sidebar-item collapsible">Databases</li>
        <ul class="nested-sidebar-list content">
          <li class="nested-sidebar-item"><a href="../databases/databases.html">What are Databases?</a></li>
          <li class="nested-sidebar-item"><a href="../databases/swift-kuery-orm.html">SQL: ORM</a></li>
          <li class="nested-sidebar-item"><a href="../databases/swift-kuery.html">SQL: Kuery</a></li>
          <li class="nested-sidebar-item"><a href="../databases/couchdb.html">NoSQL: CouchDB</a></li>
        </ul>
        <li class="sidebar-item collapsible">Sessions</li>
        <ul class="nested-sidebar-list content">
          <li class="nested-sidebar-item"><a href="../sessions/sessions.html">What are Sessions?</a></li>
          <li class="nested-sidebar-item"><a href="../sessions/kitura-session.html">Raw Routing Session</a></li>
          <li class="nested-sidebar-item"><a href="../sessions/type-safe-session.html">Codable Routing Session</a></li>
        </ul>
        <li class="sidebar-item collapsible">Authentication</li>
        <ul class="nested-sidebar-list content">
          <li class="nested-sidebar-item"><a href="../authentication/authentication.html">What is Authentication?</a></li>
          <li class="nested-sidebar-item"><a href="../authentication/typesafe-auth.html">Basic Authentication</a></li>
          <li class="nested-sidebar-item"><a href="../authentication/jwt-auth.html">JSON Web Tokens</a></li>
          <li class="nested-sidebar-item"><a href="../authentication/fb-google-oauth2.html">OAuth 2.0 with Facebook/Google</a></li>
        </ul>
        <li class="sidebar-item collapsible">Web Application</li>
        <ul class="nested-sidebar-list content">
          <li class="nested-sidebar-item"><a href="../templating/templating.html">What are Web Applications?</a></li>
          <li class="nested-sidebar-item"><a href="../templating/static-file-server.html">Static File Server</a></li>
          <li class="nested-sidebar-item"><a href="../templating/stencil.html">Stencil</a></li>
          <li class="nested-sidebar-item"><a href="../templating/markdown.html">Markdown</a></li>
        </ul>
        <li class="sidebar-item collapsible">Deploying</li>
        <ul class="nested-sidebar-list content">
          <li class="nested-sidebar-item"><a href="../deploying/monitoring.html">Monitoring</a></li>
          <li class="nested-sidebar-item"><a href="../deploying/ssl.html">Enabling SSL/TLS</a></li>
          <li class="nested-sidebar-item"><a href="../deploying/docker.html">Docker</a></li>
          <li class="nested-sidebar-item"><a href="../deploying/kubernetes.html">Kubernetes</a></li>
          <li class="nested-sidebar-item"><a href="../deploying/cloud-foundry.html">Cloud Foundry</a></li>
        </ul>
      </ul>
    </aside>
    <div id="burgerIcon" class="burger-icon" onclick="showSidebar()">
      <div class="burger-line"></div>
      <div class="burger-line"></div>
      <div class="burger-line"></div>
    </div>
    <div class="docs-item-2 search-container">
    </div>
    <nav class="docs-item-3 docs-nav">
      <button id="api-button" class="apiref-button" type="button" name="button" onclick="window.open('https://ibm-swift.github.io/Kitura/')">API Reference</button>
      <a class="nav-item" target="_blank" href="http://slack.kitura.io/">Need help?</a>
      <a class="nav-item" target="_blank" href="https://github.com/IBM-Swift/kitura.io/issues">Found an issue?</a>
    </nav>
    <div id="doc-container" class="docs-item-4 docs-window">
      <main>
        <h1 class="heading-1">What is routing?</h1>
        <p class="block-text">Routing is the way in which requests (the combination of a URL and a HTTP method) are routed to the code that handles them.</p>
        <p class="block-text">When you navigated to <a target="_blank" href="www.kitura.io">www.kitura.io</a> in your browser you were requesting the HTML file that is located there.
             The server hosting the files will respond with the requested file, if it exists, and you will see the file rendered in your browser.
              This means that under the covers there’s a server hosting the files for the kitura.io website.
              In this server there is a route defined that states if we receive a GET request on <strong>"/"</strong> then respond with the home page.</p>
        <p class="block-text">Here we mentioned a GET request being made on <strong>"/"</strong> but what does that mean? In the next section we will look at GET, which is an HTTP Method, in more detail.</p>
        <h2 class="heading-2">REST APIs</h2>
        <p class="block-text">Representational state transfer (REST) or RESTful APIs are a way of building web services to allow clients and servers to communicate using standard HTTP protocols. Essentially it’s an architectural and design pattern for building an API using HTTP methods, URI paths, and request and response body data.</p>
        <h3 class="heading-3">HTTP Methods</h3>
        <p class="block-text">An HTTP method is the part that defines what type of REST API we are calling. For example: A GET request gets a resource from the specified location, hence the name GET.</p>
        <p class="block-text">Below is a table of the main HTTP methods used in REST, listing their primary usage, what the request body should contain and what response we should expect from a call of that type.</p>
        <table>
          <thead>
            <tr>
              <th>HTTP Method</th>
              <th>Usage</th>
              <th>Request Body</th>
              <th>Response Body</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>GET</td>
              <td>The GET method is used to retrieve resources only</td>
              <td>No request body needed</td>
              <td>Reponds with resource</td>
            </tr>
            <tr>
              <td>POST</td>
              <td>The POST method is used to create a new resource</td>
              <td>The resource to be created</td>
              <td>Reponds with the created resource</td>
            </tr>
            <tr>
              <td>PUT</td>
              <td>The PUT method updates an existing resource</td>
              <td>The new version of a resource</td>
              <td>Responds with the updated resource</td>
            </tr>
            <tr>
              <td>DELETE</td>
              <td>The DELETE method deletes an existing resource</td>
              <td>No request body needed</td>
              <td>No reponse body</td>
            </tr>
            <tr>
              <td>PATCH</td>
              <td>The PATCH method makes a partial update to a resource</td>
              <td>The partially updated resource</td>
              <td>Responds with the updated resource</td>
            </tr>
          </tbody>
        </table>
        <h3 class="heading-3">URI Paths</h3>
        <p class="block-text">A URI path is the path upon which this route is linked. That is to say when a request is made to the specified path we know this is the code block to execute. Here is an example:</p>
        <pre><code class="language-swift">router.get("/hello")</code></pre>
        <p class="block-text">Above is an example of registering a GET method on the <strong>"/hello"</strong> path. Let's assume our server is running at <strong>localhost:8080</strong>, then if I want to make a call to this endpoint I could open <strong>http://localhost:8080/hello</strong> in my browser and view the response.</p>
        <h3 class="heading-3">Route handler</h3>
        <p class="block-text">Each route has a route handler. This is a closure or function that is executed when a request is made to the route's path. The route handlers contain the developer's logic for how to process incoming requests and what response should be sent.</p>
	<p class="block-text">If multiple route handlers match the path, they will be executed in the order that they are registered on the router. This is important when using middlewares, since they should normally be executed before the other handlers.</p>
        <p class="block-text">Kitura provides two 'types' of routing, Raw Routing and Codable Routing. Over the next couple of sections we will discuss them and highlight their differences.</p>
        <div class="underline"></div>
        <h2 class="heading-2">Raw Routing</h2>
        <p class="block-text">Raw routing is where the route handlers were called with <strong>RouterRequest</strong> and <strong>RouterResponse</strong> objects with which to handle the client request and build the response, along with a next completion handler. This approach provides great flexibility and control, but requires you to understand the structure of requests, how to interpret HTTP request headers correctly, how to verify data, and to manually carry out things like JSON parsing.</p>
        <p>The following is an example of a Raw Route:</p>
        <pre><code class="language-swift">router.get("/") { request, response, next in
    response.send("Hello world")
    next()
}</code></pre>
        <h3 class="heading-3">Router Request</h3>
        <p class="block-text">The <strong>RouterRequest</strong> class is used to interact with incoming HTTP requests to the router. It contains and allows access to the request’s headers and body as well as other properties of the request. It can also perform content negotiation based on the request’s <strong>Accept</strong> header.</p>
        <h3 class="heading-3">Router Response</h3>
        <p class="block-text">The <strong>RouterResponse</strong> class is used to define and work with the response that will be sent by the router. It contains and allows access to the HTTP response code (e.g. 404 Not Found), the HTTP headers and the body of the response. It can also render template files, using a template engine registered to the router.</p>
        <h3 class="heading-3">Next</h3>
        <p>In Kitura, multiple handlers can be registered on a single route. The handlers can alter the request or response before passing them to the next handler. By having the <strong>next</strong> closure, we can register a handler that acts as a middleware and is called before your routes.</p>
        <p>Once a handler is finished, it calls the next handler using the <strong>next()</strong> closure. If there are no more handlers, the router will send the response.
           If there was an error and you do not want to call the next handler, you can call <strong>request.end()</strong> to send back the response immediately.
           You must call <strong>next()</strong> or <strong>request.end()</strong> once, and only once, in each route handler because the route handlers are asynchronous.</p>
        <p>For example:</p>
        <pre><code class="language-swift">router.get("/") { request, response, next in
    response.send("Hello from the 1st route!")
    next()
}

router.get("/") { request, response, next in
    response.send("Hello from the 2nd route!")
    next()
}</code></pre>
        <p>If a request comes into the server on <strong>"/"</strong> then the following would be returned to the client:</p>
        <pre><code>"Hello from the 1st route!"
"Hello from the 2nd route!"</code></pre>
        <p class="block-text">As you can see one route is called immediately after the other, this is made possible because of <strong>next()</strong>.</p>
        <div class="underline"></div>
        <h2 class="heading-2">Codable Routing</h2>
        <p class="block-text">Codable routing is where the route handlers are like normal functions you might define elsewhere in your code; they take struct or class types as parameters, and respond with struct or class types via a completion handler. The only requirement is that those types conform to the <strong>Codable</strong> protocol introduced in Swift 4 (hence the name).</p>
        <pre><code class="language-swift">func getHandler(completion: ([String]?, RequestError?) -> Void) {
    completion(["Hello World!"], nil)
}

router.get("/", handler: getHandler)</code></pre>
        <h2 class="heading-3" id="bookmodel"> Codable model</h2>
        <p class="block-text">Any type that conforms to <strong>Codable</strong> can be used as a parameter in Codable routing, including custom structs and classes.
            As we are simulating a bookstore in our guides, we are going to need to define a book.
            The book is a model so the first thing we need to do is create our Models folder:</p>
            <pre><code>mkdir Sources/Application/Models</code></pre>
            <p>This is the directory where we will store all of our models.</p>
            <p>Next we will create our <strong>Book.swift</strong> file:</p>
            <pre><code>touch Sources/Application/Models/Book.swift</code></pre>
            <p>We will open the <strong>Book.swift</strong> file in our default text editor:</p>
            <pre><code>open Sources/Application/Models/Book.swift</code></pre>
            <p>Inside this file we define our Book:</p>
            <pre><code class="language-swift">struct Book: Codable {
    let id: Int
    let title: String
    let price: Double
    let genre: String

    init(id: Int, title: String, price: Double, genre: String) {
        self.id = id
        self.title = title
        self.price = price
        self.genre = genre
    }
}</code></pre>
        <div class="underline"></div>
        <h2 class="heading-2">Conclusion</h2>
        <p class="block-text">Codable routing provides a simple approach to building RESTful APIs. It adds compile-time type safety, creates cleaner code and can automatically generate an <a target="_blank" href="https://swagger.io/docs/specification/about/">OpenAPI specification</a>. If you are building a <a target="_blank" href="https://samnewman.io/patterns/architectural/bff/">Backend For Frontend (BFF)</a> for an iOS app, you should probably use Codable routing.</p>
        <p class="block-text">Raw routing is more flexible and provides greater control over your route handler implementation but does not have the same inherent type safety. If you are creating a non-RESTful API, such as a web application, then you will need to use Raw routing.</p>
        <div class="underline"></div>
        <h2 class="heading-2">Next steps</h2>
        <p><a href="codable-routing.html"><span class="blue-text bold">Add Codable Routing:</span></a> Use Kitura's Codable routing to define routes on your server.</span></a> </p>
        <p><a href="raw-routing.html"><span class="blue-text bold">Add Raw Routing:</span></a> Use Kitura's Raw routing to define routes on your server.</p>
      </main>
    </div>
    <div id="top-page" class="top-page">
      <a href="#">Back to top</a>
    </div>
  </section>
  <script src="../../scripts/prism.js"></script>
  <script type="text/javascript" src="../../scripts/learn.js"></script>
</body>
</html>
